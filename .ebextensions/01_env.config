option_settings:
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 8080
    DB_PROVIDER: postgres
    PG_MAX_POOL_SIZE: 10
    TOKEN_SECRET: '#{SecureRandom.hex(32)}'
    ALLOWED_ORIGINS: 
      "Fn::Join":
        - ","
        - - "Fn::Sub": "https://${AWS::Region}.elasticbeanstalk.com"
          - "Fn::Sub": "https://${ApplicationURL}"
    STATIC_FILES_PATH: '/var/app/current/backend/public'

  # Configure proxy server
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: nginx

  # Configure health check path
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /health

  # Configure enhanced health monitoring
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced

Parameters:
  ApplicationURL:
    Type: String
    Description: The URL of your application (without https://)
    Default: example.com