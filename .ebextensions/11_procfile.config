files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/99_restart_application.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # Script to explicitly set the command to run the Node.js application
      
      # Create a custom Procfile to ensure the correct startup command
      cat > /var/app/current/Procfile << 'EOL'
      web: cd backend && npm start
      EOL
      
      # Restart the application to use the new Procfile
      systemctl restart web.service
      
      exit 0